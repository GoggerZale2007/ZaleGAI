<!DOCTYPE html>
<html>
<head> <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <title>ZaleGAI 1.0</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        /* Styling for Markdown Code Blocks */
pre {
    background: #2d2d2d;
    color: #f8f8f2;
    padding: 15px;
    border-radius: 8px;
    overflow-x: auto; /* Allows scrolling sideways for long code */
    font-size: 14px;
}
code { font-family: monospace; }
.bot ul, .bot ol { padding-left: 20px; } /* Fixes list spacing */

    </style> :root {
    --bg-color: #ffffff;
    --text-color: #333333;
    --header-bg: #1a73e8;
    --header-text: #ffffff;
    --user-msg-bg: #f0f0f0;
    --bot-msg-bg: #ffffff;
    --input-bg: #ffffff;
}

[data-theme="dark"] {
    --bg-color: #121212;
    --text-color: #f1f1f1;
    --header-bg: #000000;
    --header-text: #ffffff;
    --user-msg-bg: #2d2d2d;
    --bot-msg-bg: #1e1e1e;
    --input-bg: #1e1e1e;
}

body { background-color: var(--bg-color); color: var(--text-color); transition: 0.3s; }
header { background-color: var(--header-bg); color: var(--header-text); }
.user { background-color: var(--user-msg-bg); }
.bot { background-color: var(--bot-msg-bg); border: 1px solid #333; }
input { background-color: var(--input-bg); color: var(--text-color); }
    
    /* Settings Button */
.settings-btn { position: absolute; top: 15px; right: 15px; font-size: 20px; cursor: pointer; background: none; border: none; }

/* The Modal (Pop-up) */
.modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
.modal-content { background: white; margin: 20% auto; padding: 20px; width: 85%; border-radius: 15px; }
.modal-content h2 { margin-top: 0; font-size: 1.2rem; }
.setting-item { margin-bottom: 15px; }
.setting-item label { display: block; font-size: 14px; margin-bottom: 5px; color: #666; }
.setting-item input, .setting-item textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; }

/* Dark Mode Helper */
body.dark-mode { background: #121212; color: white; }
body.dark-mode .modal-content { background: #1e1e1e; color: white; }
body.dark-mode .input-area, body.dark-mode header { background: #1e1e1e; border-color: #333; }
body.dark-mode input { color: white; }
    <div class="setting-item">
    <label>Appearance</label>
    <button id="themeToggle" onclick="toggleDarkMode()" style="width:100%; padding:10px; border-radius:8px; cursor:pointer;">
        üåô Switch to Dark Mode
    </button>
    </div>
    
</head>   
<body>

    <header id="mainHeader">ZaleGAI 1.0</header>

    <button class="settings-btn" onclick="toggleModal()">‚öôÔ∏è</button>

    <div id="chat">
        <div class="msg bot">Hello! I am ZaleGAI 1.0. How can I help you today?</div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <h2>ZaleGAI Settings</h2>
            <div class="setting-item">
                <label>Assistant Name</label>
                <input type="text" id="setBotName" placeholder="ZaleGAI 1.0">
            </div>
            <div class="setting-item">
                <label>System Instructions</label>
                <textarea id="setSystemPrompt" rows="3">You are ZaleGAI, a helpful assistant.</textarea>
            </div>
            <button onclick="saveSettings()" style="width:100%; border-radius:10px; background: black; color: white; padding: 10px;">Save & Close</button>
        </div>
    </div>

</body>
    
<body>
    <div id="chat"></div>
    <div class="input-area">
        <input type="text" id="userInput" placeholder="Ask me anything...">
        <button onclick="askAI()">Send</button>
    </div>

    <script>
        const API_KEY = "AIzaSyAvlWnUtHb8BvtJBaRFUTZF9ah85HFP_Ag"; // PASTE YOUR KEY HERE
        const chat = document.getElementById('chat');

        async function askAI() {
            const input = document.getElementById('userInput');
            const text = input.value.trim();
            if (!text) return;

            // Show User Message
            addMessage(text, 'user');
            input.value = '';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: text }] }] })
                });

                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;
                addMessage(aiResponse, 'bot');
            } catch (error) {
                addMessage("Oops! Something went wrong. Check your API key.", 'bot');
            }
        }

        function addMessage(text, sender) {
            const div = document.createElement('div');
            div.className = `msg ${sender}`;
            div.innerText = text;
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        }
    </script> // 1. Initialize the history array outside the function
let chatHistory = []; 

async function askAI() {
    const input = document.getElementById('userInput');
    const text = input.value.trim();
    if (!text) return;

    // 2. Add User Message to UI
    addMessage(text, 'user');
    
    // 3. Add User Message to memory (History)
    chatHistory.push({
        role: "user",
        parts: [{ text: text }]
    });

    input.value = '';
    typingIndicator.style.display = 'block';
    chat.scrollTop = chat.scrollHeight;

    try {
        // 4. Send the ENTIRE history to the API
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                contents: chatHistory,
                // This keeps your "ChatGPT" personality active
                systemInstruction: { parts: [{ text: systemPrompt }] }
            })
        });

        const data = await response.json();
        
        // Handle potential errors from API
        if (!data.candidates) throw new Error("Invalid API Response");

        const aiResponse = data.candidates[0].content.parts[0].text;

        // 5. Add the AI's response to memory so it remembers for next time
        chatHistory.push({
            role: "model",
            parts: [{ text: aiResponse }]
        });

        typingIndicator.style.display = 'none';
        addMessage(aiResponse, 'bot');
    } catch (error) {
        console.error(error);
        typingIndicator.style.display = 'none';
        addMessage("Memory Error: I forgot what we were talking about. Please check your API key.", 'bot');
    }
}
</script> function addMessage(text, sender) {
    const div = document.createElement('div');
    div.className = `msg ${sender}`;
    
    if (sender === 'bot') {
        // Use marked.parse to convert AI text to HTML (bold, lists, code)
        div.innerHTML = marked.parse(text);
        
        // This part highlights code blocks if you added the highlight.js link above
        div.querySelectorAll('pre code').forEach((block) => {
            hljs.highlightElement(block);
        });
    } else {
        div.innerText = text; // Keep user text as plain text for security
    }

    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
}
</script> function toggleDarkMode() {
    const body = document.body;
    const btn = document.getElementById('themeToggle');
    
    if (body.getAttribute('data-theme') === 'dark') {
        body.removeAttribute('data-theme');
        btn.innerText = "üåô Switch to Dark Mode";
        localStorage.setItem('theme', 'light');
    } else {
        body.setAttribute('data-theme', 'dark');
        btn.innerText = "‚òÄÔ∏è Switch to Light Mode";
        localStorage.setItem('theme', 'dark');
    }
}

// Run this when the page loads to apply saved theme
window.onload = function() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        document.body.setAttribute('data-theme', 'dark');
        document.getElementById('themeToggle').innerText = "‚òÄÔ∏è Switch to Light Mode";
    }
};
</head> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/1698/1698535.png">
    
</body>
</html>
